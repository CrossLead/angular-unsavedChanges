angular.module("unsavedChanges",[]).provider("unsavedWarningsConfig",function(){var e=false;var b=true;var d="$locationChangeStart";var c="You will lose unsaved changes if you leave this page";var a="You will lose unsaved changes if you reload this page";this.enableLogging=function(f){e=f};this.setRouteEventToWatchFor=function(f){d=f};this.setNavigateMessage=function(f){c=f};this.setReloadMessage=function(f){a=f};this.setUseTranslateService=function(f){b=f};this.$get=["$injector",function(f){return{isLoggingEnabled:function(){return e},logIfEnabled:function(){if(e){if(arguments.length===2){0}if(arguments.length===1){0}}},getRouteEvent:function(){return d},getNavigateMessage:function(){return c},getNavigateMessageTranslated:function(){if(b&&f.has("$translate")){return f.get("$translate")(c)}return c},getReloadMessage:function(){return a},getUseTranslateService:function(){return b}}}]}).service("unsavedWarningSharedService",function(i,d,j){var b=[];var f=true;var h=function(){};var e={navigate:d.getNavigateMessage(),reload:d.getReloadMessage()};function c(k){if(j.has("$translate")&&d.getUseTranslateService()){return j.get("$translate")(k)}else{return k}}function g(){f=true;angular.forEach(b,function(l,k){d.logIfEnabled("Form : "+l.$name+" dirty : "+l.$dirty);if(l.$dirty){f=false}d.logIfEnabled("full form",l)});return f}this.init=function(k){d.logIfEnabled("adding form",k);b.push(k)};this.removeForm=function(l){var k=b.indexOf(l);if(-1!==k){b.splice(k,1);d.logIfEnabled("Removing form from watch list",l)}};this.removePrompt=function(){b=[];h();window.onbeforeunload=null};this.confirmExit=function(){if(!g()){return c(e.reload)}else{h();window.onbeforeunload=null}};window.onbeforeunload=this.confirmExit;var a=d.getRouteEvent();h=i.$on(a,function(l,k,m){d.logIfEnabled("user is moving");if(!g()){d.logIfEnabled("form is dirty");if(!confirm(c(e.navigate))){d.logIfEnabled("user wants to cancel leaving");l.preventDefault()}else{d.logIfEnabled("user doesnt care about loosing stuff")}}else{d.logIfEnabled("form is clean")}})}).directive("unsavedWarningClear",function(a){return{scope:true,require:"^form",priority:3000,link:function(d,c,b,e){c.bind("click",function(f){e.$setPristine()})}}}).directive("unsavedWarningForm",function(a){return{require:"form",link:function(d,c,b,e){var f=e;a.init(f);c.bind("submit",function(g){f.$setPristine()});d.$on("$destroy",function(){a.removeForm(f)})}}});